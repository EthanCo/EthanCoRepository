# Android中的Http通信 #
## OSI模型 ##
物理层、数据链路层、网络层、传输层、会话层、表示层和应用层

## TCP和IP协议 ##
TCP/IP（TransmissionControlProtocol/InternetProtocol的简写，中文译名为传输控制协议/互联网络协议)。简单地说，就是由底层的IP协议和TCP协议组成的。TCP/IP其实是两个网络基础协议：IP协议、TCP协议名称的组合。下面谈谈这两个无处不在的协议。
IP协议：
IP（InternetProtocol）协议的英文名直译就是：因特网协议。从这个名称我们就可以知道IP协议的重要性。在现实生活中，我们进行货物运输时都是把货物包装成一个个的纸箱或者是集装箱之后才进行运输，在网络世界中各种信息也是通过类似的方式进行传输的。IP协议规定了数据传输时的基本单元和格式。如果比作货物运输，IP协议规定了货物打包时的包装箱尺寸和包装的程序。除了这些以外，IP协议还定义了数据包的递交办法和路由选择。同样用货物运输做比喻，IP协议规定了货物的运输方法和运输路线。
TCP协议：
我们已经知道了IP协议很重要，IP协议已经规定了数据传输的主要内容，在IP协议中定义的传输是单向的，也就是说发出去的货物对方有没有收到我们是不知道的。就好像8毛钱一份的平信一样。那对于重要的信件我们要寄挂号信怎么办呢？TCP协议就是帮我们寄“挂号信”的。TCP协议提供了可靠的面向对象的数据流传输服务的规则和约定。简单的说在TCP模式中，对方发一个数据包给你，你要发一个确认数据包给对方。通过这种确认来提供可靠性。

## TCP/IP、HTTP、Socket的区别 ##
[传送门](http://jingyan.baidu.com/article/08b6a591e07ecc14a80922f1.html)   
IP协议对应于网络层  
TCP协议对应于传输层  
HTTP协议对应于应用层  

socket是对TCP/IP协议的封装和应用 (程序员层面上)  
TPC/IP是传输层协议，主要解决数据如何在网络中传输  
HTTP是应用层协议，主要解决如何包装数据  

> 关于TCP/IP和HTTP协议的关系，网络有一段比较容易理解的介绍:  
> 我们在传输数据时，可以只使用(传输层)TCP/IP协议，但是那样的话，如果没有应用层，便无法识别数据内容。  
> 如果想要使传输的数据有意义，则必须使用到应用层协议。  
> 应用层协议有很多，比如HTTP、FTP、TELNET等，也可以自己定义应用层协议。  

WEB使用HTTP协议作应用层协议，以封装HTTP文本信息，然后使用TCP/IP做传输层协议将它发送到网络上。  
Socket是对TCP/IP协议的封装，SOkcet本身并不是协议，而是一个调用接口(API)。  
通过Socket，我们才能使用TCP/IP协议。
实际上，SOcket和TCP/IP协议没有必然的联系，  
Socket编程接口在设计的时候，就希望也能适应其他的网络协议。  
所以说，Socket的出现只是使得程序员更方便地使用TCP/IP协议栈而已，是对TCP/IP协议的抽象，从而形成了我们知道的一些最基本的函数接口，比如create，listen，connect，accept，send，read和write等等  

> 网上有一段关于Sokcet和TCP/IP协议关系的说法比较容易理解:  
> TCP/IP只是一个协议栈，就像操作系统的运行机制一样，必须要具体实现，同时还要提供对外的操作接口。这个就像操作系统会提供标准的编程接口，比如win32编程接口一样，TCP/IP也要提供可供程序员做网络开发所用的接口，这就是Socket编程接口。 

## 什么是Http协议 ##
超文本传输协议(HTTP-Hypertext transfer protocal)定义了   

- 怎么向万维网服务器请求万维网文档
- 服务器怎么把文档传递给浏览器

> HTTP是基于TCP/IP之上的一个协议
####  ####
	HTTP是面向应用层协议，它是万维网上能够可靠地交换文件的重要基础

## 工作流程 ##
一次HTTP操作称作为一个事务，其工作过程可以分为四步

1. 首先客户机与服务器需要建立连接，只要单击某个超级链接，HTTP的工作开始
2. 建立连接后，客户机发送一个请求给服务器，请求方式的格式为: 统一资源标识符(URL)、协议版本号，后边是MIME信息包括请求修饰符、客户机信息和可能的内容。
3. 服务器接到请求后，给予相应的相应信息，其格式为一个状态行，包括信息的协议版本号、一个成功或失败的代码，后边是MIME信息包括服务器信息、实体信息和可能的内容。
4. 客户端接收到服务器所返回的信息通过浏览器显示在用户的显示屏上，然后客户机和服务器断开连接。

> 如果在以上过程中的某一步出现错误，那么产生错误的信息将返回到客户端，由显示屏输出。对于用户来说，这些过程是由HTTP自己完成的，用户只要用鼠标点击，等待信息显示就可以了。

访问网址，它就会通过浏览器向我们服务器发送一个请求，它遵循的是一个HTTP协议，根据URL去向服务器发送一个请求，服务器根据这个URL去解析相应的服务器的地址信息，然后访问特定的服务器，之后，服务器给我们返回这样的一个页面信息，(客户端发送请求，服务器相应的一个过程)。整个打开网页的过程就是一个HTTP请求的过程。

### URL ###
https:经过加密的，所有的数据都是经过加密的

## HCP/IP ##
### TCP的三次握手 ###
SYN(synchronous)是TCP/IP建立连接时使用的握手信号。在客户机和服务器之间建立正常的TCP网络连接时，客户机首先发送一个SYN消息，服务器使用SYN+ACK应答表示接收到了这个消息，最后客户机再以ACK消息响应，这样在客户机和服务器之间才能建立起可靠的TCP连接，数据才可以在客户机和服务器之间传递。   
ACK(Acknowledgement)，即确认字符，在数据通信中，接收站发送给发送站的一种传输类控制字符，表示发来的数据已确认接收无误。  

![](http://i4.piimg.com/5c06ed1ed3ce553f.png)
#### 第一次握手 ####
客户端发送syn包(syn=j)到服务器，并进入SYN_SEND状态，等待服务器确认。  
#### 第二次握手 ####
服务器收到syn包，必须确认客户的SYN(ack=j+1)，同时自己也发送一个SYN包(syn=k)，即SYN+ACK包，同时服务器进入SYN_RECV状态  
#### 第三次握手 ####
客户端收到服务器的SYN+ACK包，向服务器发送确认包ACK(ack=k+1)，此包发送完毕，客户端和服务器进入ESTABLISHED状态，完成三次握手。

### HTTP协议主要特点 ###
1. 支持客户/服务器模式  
2. 简单快速:客户想服务器请求服务时，只传递请求方法和路径。请求方法常用的有GET、HEAD、POST。每种方法规定了客户与服务器联系的类型不同。由于HTTP协议简单，使得HTTP服务器的程序规模小，因而通信速率很快。
3. 灵活: HTTP允许传输任意类型的数据对象。正在传输的类型有COntent-Type加以标记。 
4. 无连接:限制每次连接只处理一个请求。服务器处理完客户的要求，并受到客户的应答后，即断开连接。采用这种方式可以节省传输时间。
5. 无状态:HTTP协议是无状态协议。无状态是指协议对于事物处理没有记忆能力。缺少状态意味着如果后续处理需要前面的信息，则它必须重传，这样可能导致每次连接传送的数据量增大。另一方面，在服务器不需要先前信息时它的应答就较快。

### HTTP1.0和HTTP1.1的区别 ###
HTTP1.0 每次请求都需要建立新的TCP连接，连接不能复用。  
HTTP1.1 新的请求可以在上次请求建立的TCP连接之上发送，连接可以复用。优点是减少重复进行TCP三次握手的开销，提高效率。  
HTTP1.1在Request消息头里多了一个Host域，HTTP1.0没有这个域，Host:www.w3.org  
HTTP1.1增加了OPTIONS，PUT,DELETE,TRACE,CONNECT这些Request方法  

## HTTPS原理 ##
[Https通讯原理](http://jingyan.baidu.com/article/2fb0ba4048e15500f3ec5f7e.html)

